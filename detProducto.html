<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Detalle del Producto</title>
	<link rel="stylesheet" href="prueba.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
	<div class="banner-superior"></div>

	<div class="container">
		<nav class="nav justify-content-between bg-body-tertiary shadow p-2 rounded align-items-center">
			<div class="d-flex">
				<a class="nav-link text-success" href="index.html">Home</a>
				<a class="nav-link text-success" href="productos.html">Productos</a>
				<a class="nav-link text-success" href="nosotros.html">Nosotros</a>
				<a class="nav-link text-success" href="blog.html">Blogs</a>
				<a class="nav-link text-success" href="contacto.html">Contacto</a>
			</div>
			<a href="carrito.html" class="nav-link text-success">
				<i class="bi bi-cart-fill"></i>
				<span class="badge bg-warning text-dark" id="cartCount">0</span>
			</a>
		</nav>
	</div>

	<div class="container my-5" id="detalle-producto">
		<div class="row g-5">
			<div class="col-md-6 text-center">
				<img id="producto-imagen" src="" alt="Imagen producto" class="product-image">
			</div>
			<div class="col-md-6">
				<div class="d-flex justify-content-between align-items-center mb-2">
					<h2 id="producto-nombre" class="product-title"></h2>
					<span id="producto-precio" class="product-price"></span>
				</div>

				<div class="divider"></div>
				<p id="producto-descripcion"></p>
				<div class="divider"></div>

				<div class="mb-3">
					<label for="cantidad" class="form-label">Cantidad</label>
					<select id="cantidad" class="form-select" style="max-width:120px;">
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
					</select>
				</div>
				<button id="addToCart" class="btn btn-success btn-lg btn-add">
					<i class="bi bi-cart-plus"></i> Agregar al carrito
				</button>
			</div>
		</div>
	</div>

	<!-- Related -->
	<div class="container my-5">
		<h3 class="mb-4 text-center">Productos Relacionados</h3>
		<div class="row g-3" id="relatedContainer">
		<!-- Se generan dinámicamente -->
		</div>
	</div>

	<!-- scripts -->
	<script src="producto.js"></script>

	<script>
	// Extraer param 'producto'
	const params = new URLSearchParams(window.location.search);
	const idProducto = params.get('producto') || 'batido-verde';

	// Buscar producto en productos.js
	const producto = productos[idProducto];

	// Elementos del DOM
	const elNombre = document.getElementById('producto-nombre');
	const elPrecio = document.getElementById('producto-precio');
	const elImagen = document.getElementById('producto-imagen');
	const elDesc = document.getElementById('producto-descripcion');
	const relatedContainer = document.getElementById('relatedContainer');
	const cartCount = document.getElementById('cartCount');

	// Función para cargar contador carrito desde localStorage
	function updateCartCount() {
		const cart = JSON.parse(localStorage.getItem('cart') || '[]');
		const total = cart.reduce((s, item) => s + Number(item.qty || 0), 0);
		cartCount.textContent = total;
	}

	if (!producto) {
		document.getElementById('detalle-producto').innerHTML = '<p>Producto no encontrado.</p>';
		updateCartCount();
	} else {
		// Poblar elementos
		elNombre.textContent = producto.nombre;
		elPrecio.textContent = producto.precioDisplay || ('$' + (producto.precio || '0'));
		elImagen.src = producto.imagen;
		elImagen.alt = producto.nombre;
		elDesc.textContent = producto.descripcion;

		// Mostrar relacionados
		relatedContainer.innerHTML = '';
		const relatedIds = producto.related || Object.keys(productos).filter(k => k !== producto.id).slice(0,3);
		relatedIds.forEach(rid => {
			const rp = productos[rid];
			if (!rp) return;
			const col = document.createElement('div');
			col.className = 'col-6 col-md-3';
			col.innerHTML = `
			<div class="related-card card shadow clickable" onclick="window.location.href='detProducto.html?producto=${rp.id}'">
				<img src="${rp.imagen}" alt="${rp.nombre}" class="producto-relacionado mb-2">
				<div style="font-weight:600">${rp.nombre}</div>
			</div>
			`;
			relatedContainer.appendChild(col);
		});

		// Botón agregar al carrito
		document.getElementById('addToCart').addEventListener('click', () => {
			const qty = Number(document.getElementById('cantidad').value || 1);
			const cart = JSON.parse(localStorage.getItem('cart') || '[]');
			const existing = cart.find(i => i.id === producto.id);
			if (existing) existing.qty = Number(existing.qty) + qty;
			else cart.push({ id: producto.id, nombre: producto.nombre, price: producto.precio, qty });
			localStorage.setItem('cart', JSON.stringify(cart));

			// feedback al usuario
			alert(`Se agregó ${qty} × ${producto.nombre} al carrito.`);
			updateCartCount();
		});

		updateCartCount();
	}
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
<!-- Footer -->
<footer class="bg-light border-top mt-5">
  <div class="container py-4">
    <div class="row">
      <!-- Columna 1: Nombre del sitio -->
      <div class="col-md-3 mb-3">
        <h6 class="text-uppercase color: #4CAF50">Detox Now</h6>
        <div class="d-flex gap-2 mt-2">
          <img src="https://img.icons8.com/color/48/000000/visa.png" alt="Visa" width="40">
          <img src="https://img.icons8.com/color/48/000000/mastercard-logo.png" alt="Mastercard" width="40">
          <img src="https://img.icons8.com/ios-filled/48/000000/paypal.png" alt="PayPal" width="40">
        </div>
      </div>

      <!-- Columna 2: Categorías -->
      <div class="col-md-4 mb-3">
        <h6 class="text-uppercase">Categorías</h6>
        <ul class="list-unstyled">
          <li><a href="#" class="text-decoration-none text-dark">Política de Privacidad</a></li>
          <li><a href="#" class="text-decoration-none text-dark">Términos y Condiciones</a></li>
          <li><a href="contacto.html" class="text-decoration-none text-dark">Contacto</a></li>
        </ul>
      </div>

      <!-- Columna 3: Newsletter -->
      <div class="col-md-5 mb-3">
        <h6 class="text-uppercase">Estas a un paso, suscribete a nuestro Newsletter:</h6>
        <form class="d-flex">
          <input type="email" class="form-control me-2" placeholder="Ingresar Email">
          <button class="btn btn-dark" type="submit">Subscribir</button>
        </form>
      </div>
    </div>
  </div>
</footer>
</html>
